<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="devMSMs">
<title>Customize Balancing Formulas • devMSMs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Customize Balancing Formulas">
<meta property="og:description" content="devMSMs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">devMSMs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Terminology.html">Terminology</a>
    <a class="dropdown-item" href="../articles/Data_Requirements.html">Data Requirements</a>
    <a class="dropdown-item" href="../articles/Specify_Core_Inputs.html">Specify Core Inputs</a>
    <a class="dropdown-item" href="../articles/Preliminary_Steps.html">Recommended Preliminary Steps</a>
    <a class="dropdown-item" href="../articles/Workflow_Continuous_Exposure.html">Workflow: Continuous Exposure</a>
    <a class="dropdown-item" href="../articles/Customize_Balancing_Formulas.html">Customize Balancing Formulas</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/istallworthy/devMSMs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Customize Balancing Formulas</h1>
                        <h4 data-toc-skip class="author">Isabella
Stallworthy</h4>
            
            <h4 data-toc-skip class="date">2024-03-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/istallworthy/devMSMs/blob/HEAD/vignettes/Customize_Balancing_Formulas.Rmd" class="external-link"><code>vignettes/Customize_Balancing_Formulas.Rmd</code></a></small>
      <div class="d-none name"><code>Customize_Balancing_Formulas.Rmd</code></div>
    </div>

    
    
<p>This vignette provides guidance on how to customize balancing
formulas for use in <em>devMSMs</em>. Please first review the
<a href="https://istallworthy.github.io/devMSMs/articles/Specify_Core_Inputs.html">Specify
Core Inputs</a> and any of the <em>Workflows</em> vignettes.</p>
<p>The code contained in this vignette is also available, integrated
code from the other vignettes, in the
<a href="https://github.com/istallworthy/devMSMs/blob/main/examplePipelineRevised.Rmd" class="external-link">examplePipeline.rmd
file</a>.</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"istallworthy/devMSMs"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: usethis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://istallworthy.github.io/devMSMs/">devMSMs</a></span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<div class="section level2">
<h2 id="core-inputs">Core Inputs<a class="anchor" aria-label="anchor" href="#core-inputs"></a>
</h2>
<p>We specify core inputs to the <em>devMSMs</em> functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="st">"ESETA1"</span></span>
<span></span>
<span><span class="va">exposure_time_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">15</span>, <span class="fl">24</span>, <span class="fl">35</span>, <span class="fl">58</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="st">"StrDif_Tot.58"</span></span>
<span></span>
<span><span class="va">tv_confounders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SAAmylase.6"</span>,<span class="st">"SAAmylase.15"</span>, <span class="st">"SAAmylase.24"</span>,</span>
<span>                    <span class="st">"MDI.6"</span>, <span class="st">"MDI.15"</span>,                                            </span>
<span>                    <span class="st">"RHasSO.6"</span>, <span class="st">"RHasSO.15"</span>, <span class="st">"RHasSO.24"</span>,<span class="st">"RHasSO.35"</span>, <span class="st">"RHasSO.58"</span>,                                         </span>
<span>                    <span class="st">"WndNbrhood.6"</span>,<span class="st">"WndNbrhood.24"</span>, <span class="st">"WndNbrhood.35"</span>, <span class="st">"WndNbrhood.58"</span>,                                       </span>
<span>                    <span class="st">"IBRAttn.6"</span>, <span class="st">"IBRAttn.15"</span>, <span class="st">"IBRAttn.24"</span>,                                   </span>
<span>                    <span class="st">"B18Raw.6"</span>, <span class="st">"B18Raw.15"</span>, <span class="st">"B18Raw.24"</span>, <span class="st">"B18Raw.58"</span>,                                           </span>
<span>                    <span class="st">"HOMEETA1.6"</span>, <span class="st">"HOMEETA1.15"</span>, <span class="st">"HOMEETA1.24"</span>, <span class="st">"HOMEETA1.35"</span>, <span class="st">"HOMEETA1.58"</span>,                               </span>
<span>                    <span class="st">"InRatioCor.6"</span>, <span class="st">"InRatioCor.15"</span>, <span class="st">"InRatioCor.24"</span>, <span class="st">"InRatioCor.35"</span>, <span class="st">"InRatioCor.58"</span>,                         </span>
<span>                    <span class="st">"ESETA1.6"</span>, <span class="st">"ESETA1.15"</span>, <span class="st">"ESETA1.24"</span>, <span class="st">"ESETA1.35"</span>, <span class="st">"ESETA1.58"</span>,             </span>
<span>                    <span class="st">"CORTB.6"</span>, <span class="st">"CORTB.15"</span>, <span class="st">"CORTB.24"</span>,                                                                  </span>
<span>                    <span class="st">"EARS_TJo.24"</span>, <span class="st">"EARS_TJo.35"</span>,                                        </span>
<span>                    <span class="st">"LESMnPos.24"</span>, <span class="st">"LESMnPos.35"</span>,                                  </span>
<span>                    <span class="st">"LESMnNeg.24"</span>, <span class="st">"LESMnNeg.35"</span>,       </span>
<span>                    <span class="st">"StrDif_Tot.35"</span>, <span class="st">"StrDif_Tot.58"</span>,    </span>
<span>                    <span class="st">"fscore.35"</span>, <span class="st">"fscore.58"</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="va">ti_confounders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"BioDadInHH2"</span>, <span class="st">"PmAge2"</span>, <span class="st">"PmBlac2"</span>, <span class="st">"TcBlac2"</span>, <span class="st">"PmMrSt2"</span>, <span class="st">"PmEd2"</span>, <span class="st">"KFASTScr"</span>,</span>
<span>                    <span class="st">"RMomAgeU"</span>, <span class="st">"RHealth"</span>, <span class="st">"HomeOwnd"</span>, <span class="st">"SWghtLB"</span>, <span class="st">"SurpPreg"</span>, <span class="st">"SmokTotl"</span>, <span class="st">"DrnkFreq"</span>,</span>
<span>                    <span class="st">"peri_health"</span>, <span class="st">"caregiv_health"</span>, <span class="st">"gov_assist"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>The <code><a href="../reference/createFormulas.html">createFormulas()</a></code> function has 3 different modes:
“full” (Steps 1 &amp; 4), “short” (Step 2), and “update” (Step 3),
corresponding to different steps in the <em>Workflows</em> vignettes,
and can be customized in each mode. We suggest staying consistent with
any customization throughout use of package workflow. We recommend being
sure to include all measured confounders (and no mediators or colliders)
for each exposure time point in the balancing formulas. Please refer to
the accompanying manuscript for more details.</p>
<p>Below, we illustrate the customization options for each of the three
modes of the <code>createFormuls()</code> function using information
from the package dataset as an example. These data are simulated based
on data from the Family Life Project (FLP), a longitudinal study
following 1,292 families representative of two geographic areas (three
counties in North Carolina and three counties in Pennsylvania) with high
rural child poverty (Vernon-Feagans et al., 2013; Burchinal et al.,
2008). We take the example exposure of economic strain (ESETA1) measured
at 6, 15, 24, 35, and 58 months in relation to the outcome of behavior
problems (StrDif_Tot) measured at 58 months.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="customize-full-balancing-formulas-steps-1-4">Customize Full Balancing Formulas (Steps 1 &amp; 4)<a class="anchor" aria-label="anchor" href="#customize-full-balancing-formulas-steps-1-4"></a>
</h2>
<p>The default use of <code><a href="../reference/createFormulas.html">createFormulas()</a></code> with
<code>type = "full"</code> creates balancing formulas at each exposure
time point. Each formula contains all time invariant confounders as well
as all time-varying confounders measured at time points prior to that
exposure time point. For example, for the 24-month balancing formula, we
would have time-varying confounders only at 6 and 15 months.</p>
<p>However, if users wish to also include any time-varying confounders
measured contemporaneously with the exposure time point (e.g., also
include 24-month time-varying confounders in the 24-month balancing
formula), they can specify those time-varying confounders in the
optional argument to <code><a href="../reference/createFormulas.html">createFormulas()</a></code>,
<code>concur_conf</code>.</p>
<p>For example, to include 24-month maternal depression in the 24-month
balancing formula:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">concur_conf</span> <span class="op">&lt;-</span> <span class="st">"B18Raw.24"</span></span></code></pre></div>
<p>Now, as shown below, B18Raw.24 is included in the 24-month balancing
formula in addition to the 35-and 58-month formulas.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"full"</span></span>
<span></span>
<span><span class="va">full_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createFormulas.html">createFormulas</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="va">exposure</span>, exposure_time_pts <span class="op">=</span> <span class="va">exposure_time_pts</span>, outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                                type <span class="op">=</span> <span class="va">type</span>, ti_confounders <span class="op">=</span> <span class="va">ti_confounders</span>, tv_confounders <span class="op">=</span> <span class="va">tv_confounders</span>, </span>
<span>                                concur_conf <span class="op">=</span> <span class="va">concur_conf</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, save.out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; The full formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 6 is: </span></span>
<span><span class="co">#&gt; ESETA1.6 ~ BioDadInHH2 + caregiv_health + DrnkFreq + gov_assist + </span></span>
<span><span class="co">#&gt;     HomeOwnd + KFASTScr + peri_health + PmAge2 + PmBlac2 + PmEd2 + </span></span>
<span><span class="co">#&gt;     PmMrSt2 + RHealth + RMomAgeU + SmokTotl + state + SurpPreg + </span></span>
<span><span class="co">#&gt;     SWghtLB + TcBlac2</span></span>
<span><span class="co">#&gt; &lt;environment: 0x56308c4f7658&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; The full formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 15 is: </span></span>
<span><span class="co">#&gt; ESETA1.15 ~ B18Raw.6 + BioDadInHH2 + caregiv_health + CORTB.6 + </span></span>
<span><span class="co">#&gt;     DrnkFreq + ESETA1.6 + gov_assist + HOMEETA1.6 + HomeOwnd + </span></span>
<span><span class="co">#&gt;     IBRAttn.6 + InRatioCor.6 + KFASTScr + MDI.6 + peri_health + </span></span>
<span><span class="co">#&gt;     PmAge2 + PmBlac2 + PmEd2 + PmMrSt2 + RHasSO.6 + RHealth + </span></span>
<span><span class="co">#&gt;     RMomAgeU + SAAmylase.6 + SmokTotl + state + SurpPreg + SWghtLB + </span></span>
<span><span class="co">#&gt;     TcBlac2 + WndNbrhood.6</span></span>
<span><span class="co">#&gt; &lt;environment: 0x56308c4f7658&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; The full formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 24 is: </span></span>
<span><span class="co">#&gt; ESETA1.24 ~ B18Raw.15 + B18Raw.24 + B18Raw.6 + BioDadInHH2 + </span></span>
<span><span class="co">#&gt;     caregiv_health + CORTB.15 + CORTB.6 + DrnkFreq + ESETA1.15 + </span></span>
<span><span class="co">#&gt;     ESETA1.6 + gov_assist + HOMEETA1.15 + HOMEETA1.6 + HomeOwnd + </span></span>
<span><span class="co">#&gt;     IBRAttn.15 + IBRAttn.6 + InRatioCor.15 + InRatioCor.6 + KFASTScr + </span></span>
<span><span class="co">#&gt;     MDI.15 + MDI.6 + peri_health + PmAge2 + PmBlac2 + PmEd2 + </span></span>
<span><span class="co">#&gt;     PmMrSt2 + RHasSO.15 + RHasSO.6 + RHealth + RMomAgeU + SAAmylase.15 + </span></span>
<span><span class="co">#&gt;     SAAmylase.6 + SmokTotl + state + SurpPreg + SWghtLB + TcBlac2 + </span></span>
<span><span class="co">#&gt;     WndNbrhood.6</span></span>
<span><span class="co">#&gt; &lt;environment: 0x56308c4f7658&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; The full formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 35 is: </span></span>
<span><span class="co">#&gt; ESETA1.35 ~ B18Raw.15 + B18Raw.24 + B18Raw.6 + BioDadInHH2 + </span></span>
<span><span class="co">#&gt;     caregiv_health + CORTB.15 + CORTB.24 + CORTB.6 + DrnkFreq + </span></span>
<span><span class="co">#&gt;     EARS_TJo.24 + ESETA1.15 + ESETA1.24 + ESETA1.6 + gov_assist + </span></span>
<span><span class="co">#&gt;     HOMEETA1.15 + HOMEETA1.24 + HOMEETA1.6 + HomeOwnd + IBRAttn.15 + </span></span>
<span><span class="co">#&gt;     IBRAttn.24 + IBRAttn.6 + InRatioCor.15 + InRatioCor.24 + </span></span>
<span><span class="co">#&gt;     InRatioCor.6 + KFASTScr + LESMnNeg.24 + LESMnPos.24 + MDI.15 + </span></span>
<span><span class="co">#&gt;     MDI.6 + peri_health + PmAge2 + PmBlac2 + PmEd2 + PmMrSt2 + </span></span>
<span><span class="co">#&gt;     RHasSO.15 + RHasSO.24 + RHasSO.6 + RHealth + RMomAgeU + SAAmylase.15 + </span></span>
<span><span class="co">#&gt;     SAAmylase.24 + SAAmylase.6 + SmokTotl + state + SurpPreg + </span></span>
<span><span class="co">#&gt;     SWghtLB + TcBlac2 + WndNbrhood.24 + WndNbrhood.6</span></span>
<span><span class="co">#&gt; &lt;environment: 0x56308c4f7658&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the full balancing formula below:</span></span>
<span><span class="co">#&gt; The full formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 58 is: </span></span>
<span><span class="co">#&gt; ESETA1.58 ~ B18Raw.15 + B18Raw.24 + B18Raw.6 + BioDadInHH2 + </span></span>
<span><span class="co">#&gt;     caregiv_health + CORTB.15 + CORTB.24 + CORTB.6 + DrnkFreq + </span></span>
<span><span class="co">#&gt;     EARS_TJo.24 + EARS_TJo.35 + ESETA1.15 + ESETA1.24 + ESETA1.35 + </span></span>
<span><span class="co">#&gt;     ESETA1.6 + fscore.35 + gov_assist + HOMEETA1.15 + HOMEETA1.24 + </span></span>
<span><span class="co">#&gt;     HOMEETA1.35 + HOMEETA1.6 + HomeOwnd + IBRAttn.15 + IBRAttn.24 + </span></span>
<span><span class="co">#&gt;     IBRAttn.6 + InRatioCor.15 + InRatioCor.24 + InRatioCor.35 + </span></span>
<span><span class="co">#&gt;     InRatioCor.6 + KFASTScr + LESMnNeg.24 + LESMnNeg.35 + LESMnPos.24 + </span></span>
<span><span class="co">#&gt;     LESMnPos.35 + MDI.15 + MDI.6 + peri_health + PmAge2 + PmBlac2 + </span></span>
<span><span class="co">#&gt;     PmEd2 + PmMrSt2 + RHasSO.15 + RHasSO.24 + RHasSO.35 + RHasSO.6 + </span></span>
<span><span class="co">#&gt;     RHealth + RMomAgeU + SAAmylase.15 + SAAmylase.24 + SAAmylase.6 + </span></span>
<span><span class="co">#&gt;     SmokTotl + state + StrDif_Tot.35 + SurpPreg + SWghtLB + TcBlac2 + </span></span>
<span><span class="co">#&gt;     WndNbrhood.24 + WndNbrhood.35 + WndNbrhood.6</span></span>
<span><span class="co">#&gt; &lt;environment: 0x56308c4f7658&gt;</span></span></code></pre></div>
<p>Alternatively, a user could completely customize the full formulas by
manually creating formulas for each exposure time point using the
optional <code>custom</code> argument. This argument must be formatted
identically to the default output of the <code><a href="../reference/createFormulas.html">createFormulas()</a></code>
function.</p>
<p>To create custom formulas, the user creates a list with an entry for
each exposure time point (labeled “full_form_t”), each of which contains
the balancing formula for exposure at that time point.
<code><a href="../reference/createFormulas.html">createFormulas()</a></code> will conduct checks to ensure there is a
formula for each time point and provides cautionary warnings for unusual
variables (e.g., those measured after the exposure time point). However,
the user is responsible for ensuring the validity of these formulas.
Users may wish to make custom formulas if they want to include any
confounder interactions or polynomials in their balancing formulas.</p>
<p>Below, we illustrate an abridged example for specifying the
<code>custom</code> arguments for the exposure, ESETA1, at 6-, 15-, 24-,
35-, and 58-month time points.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"full_form-6"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"ESETA1.6 ~ BioDadInHH2 + DrnkFreq + gov_assist"</span><span class="op">)</span>,</span>
<span>               <span class="st">"full_form-15"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"ESETA1.15 ~ BioDadInHH2 + DrnkFreq + gov_assist"</span><span class="op">)</span>,</span>
<span>               <span class="st">"full_form-24"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"ESETA1.24 ~ BioDadInHH2 + DrnkFreq + gov_assist"</span><span class="op">)</span>,</span>
<span>               <span class="st">"full_form-35"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"ESETA1.35 ~ BioDadInHH2 + DrnkFreq + gov_assist"</span><span class="op">)</span>,</span>
<span>               <span class="st">"full_form-58"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"ESETA1.58 ~ BioDadInHH2 + DrnkFreq + gov_assist"</span><span class="op">)</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<p><code>customFormulas()</code> then checks and retains these formulas
for further use with the package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createFormulas.html">createFormulas</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="va">exposure</span>, exposure_time_pts <span class="op">=</span> <span class="va">exposure_time_pts</span>, outcome <span class="op">=</span> <span class="va">outcome</span>, </span>
<span>                                type <span class="op">=</span> <span class="va">type</span>, ti_confounders <span class="op">=</span> <span class="va">ti_confounders</span>, tv_confounders <span class="op">=</span> <span class="va">tv_confounders</span>, </span>
<span>                                custom <span class="op">=</span> <span class="va">custom</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, save.out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; The user-supplied custom balancing formula for each exposure time point are below:</span></span>
<span><span class="co">#&gt; ESETA1.6 ~ BioDadInHH2 + DrnkFreq + gov_assist</span></span>
<span><span class="co">#&gt; ESETA1.15 ~ BioDadInHH2 + DrnkFreq + gov_assist</span></span>
<span><span class="co">#&gt; ESETA1.24 ~ BioDadInHH2 + DrnkFreq + gov_assist</span></span>
<span><span class="co">#&gt; ESETA1.35 ~ BioDadInHH2 + DrnkFreq + gov_assist</span></span>
<span><span class="co">#&gt; ESETA1.58 ~ BioDadInHH2 + DrnkFreq + gov_assist</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="customize-short-balancing-formulas-step-2">Customize Short Balancing Formulas (Step 2)<a class="anchor" aria-label="anchor" href="#customize-short-balancing-formulas-step-2"></a>
</h2>
<p>The default use of <code><a href="../reference/createFormulas.html">createFormulas()</a></code> with
<code>type = "short"</code> creates shortened balancing formulas at each
exposure time point. Each formula contains all time invariant
confounders as well as only those time-varying confounders measured at
the time point directly prior (<em>t</em>-1 lag) to that exposure time
point. For example, for the 24-month balancing formula, we would only
include time-varying confounders at 15 months. Please see the
<em>Workflows</em> vignettes and accompanying manuscript for more
detail.</p>
<p>When creating short formulas, the user can specify the optional
<code>concur_conf</code> and <code>custom</code> arguments detailed
above. Of note, <code><a href="../reference/createFormulas.html">createFormulas()</a></code> does not check that
formulas in the <code>custom</code> field meet criteria for the
shortened formula, and the user is responsible for ensuring the validity
of these formulas.</p>
<p>When creating short formulas, the user can also specify an optional
<code>keep_conf</code> argument. Users would specify this second
argument with any time-varying confounders to always retain in the
formulas, in lagged form, overriding the <em>t</em>-1 lag default. Users
may wish to use this argument if they have time-varying confounders that
are not highly consistent over time and have strong reasons to include
them in the initial phase of selecting the optimal weighting method (see
<em>Workflows</em> vignettes for more details). Note that unless these
variables are also specified in <code>concuf_conf</code>, they will only
be retained in lagged form.</p>
<p>For example, to always retain income in all formulas in lagged form,
overriding the <em>t</em>-1 lag default:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keep_conf</span> <span class="op">&lt;-</span> <span class="st">"InRatioCor.6"</span></span></code></pre></div>
<p>As shown below, the <code>createFormulas</code> function now retains
income at 6 months in all 15-, 24-, 35-, and 58-month formulas,
overriding the <em>t</em>-1 lag rule for that variable. Without this
specification, income at 6 months would have been omitted in formulas
for exposure at 24, 35, and 58 months.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"short"</span> </span>
<span></span>
<span><span class="va">short_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createFormulas.html">createFormulas</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="va">exposure</span>, exposure_time_pts <span class="op">=</span> <span class="va">exposure_time_pts</span>, outcome <span class="op">=</span> <span class="va">outcome</span>,</span>
<span>                                 type <span class="op">=</span> <span class="va">type</span>, ti_confounders <span class="op">=</span> <span class="va">ti_confounders</span>, tv_confounders <span class="op">=</span> <span class="va">tv_confounders</span>, </span>
<span>                                 keep_conf <span class="op">=</span> <span class="va">keep_conf</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, save.out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; The short formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 6 is: </span></span>
<span><span class="co">#&gt; ESETA1.6 ~ BioDadInHH2 + caregiv_health + DrnkFreq + gov_assist + </span></span>
<span><span class="co">#&gt;     HomeOwnd + KFASTScr + peri_health + PmAge2 + PmBlac2 + PmEd2 + </span></span>
<span><span class="co">#&gt;     PmMrSt2 + RHealth + RMomAgeU + SmokTotl + state + SurpPreg + </span></span>
<span><span class="co">#&gt;     SWghtLB + TcBlac2</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5630949e29f0&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; The short formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 15 is: </span></span>
<span><span class="co">#&gt; ESETA1.15 ~ B18Raw.6 + BioDadInHH2 + caregiv_health + CORTB.6 + </span></span>
<span><span class="co">#&gt;     DrnkFreq + ESETA1.6 + gov_assist + HOMEETA1.6 + HomeOwnd + </span></span>
<span><span class="co">#&gt;     IBRAttn.6 + InRatioCor.6 + KFASTScr + MDI.6 + peri_health + </span></span>
<span><span class="co">#&gt;     PmAge2 + PmBlac2 + PmEd2 + PmMrSt2 + RHasSO.6 + RHealth + </span></span>
<span><span class="co">#&gt;     RMomAgeU + SAAmylase.6 + SmokTotl + state + SurpPreg + SWghtLB + </span></span>
<span><span class="co">#&gt;     TcBlac2 + WndNbrhood.6</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5630949e29f0&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; The short formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 24 is: </span></span>
<span><span class="co">#&gt; ESETA1.24 ~ B18Raw.15 + BioDadInHH2 + caregiv_health + CORTB.15 + </span></span>
<span><span class="co">#&gt;     DrnkFreq + ESETA1.15 + gov_assist + HOMEETA1.15 + HomeOwnd + </span></span>
<span><span class="co">#&gt;     IBRAttn.15 + InRatioCor.15 + InRatioCor.6 + KFASTScr + MDI.15 + </span></span>
<span><span class="co">#&gt;     peri_health + PmAge2 + PmBlac2 + PmEd2 + PmMrSt2 + RHasSO.15 + </span></span>
<span><span class="co">#&gt;     RHealth + RMomAgeU + SAAmylase.15 + SmokTotl + state + SurpPreg + </span></span>
<span><span class="co">#&gt;     SWghtLB + TcBlac2</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5630949e29f0&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; The short formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 35 is: </span></span>
<span><span class="co">#&gt; ESETA1.35 ~ B18Raw.24 + BioDadInHH2 + caregiv_health + CORTB.24 + </span></span>
<span><span class="co">#&gt;     DrnkFreq + EARS_TJo.24 + ESETA1.24 + gov_assist + HOMEETA1.24 + </span></span>
<span><span class="co">#&gt;     HomeOwnd + IBRAttn.24 + InRatioCor.24 + InRatioCor.6 + KFASTScr + </span></span>
<span><span class="co">#&gt;     LESMnNeg.24 + LESMnPos.24 + peri_health + PmAge2 + PmBlac2 + </span></span>
<span><span class="co">#&gt;     PmEd2 + PmMrSt2 + RHasSO.24 + RHealth + RMomAgeU + SAAmylase.24 + </span></span>
<span><span class="co">#&gt;     SmokTotl + state + SurpPreg + SWghtLB + TcBlac2 + WndNbrhood.24</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5630949e29f0&gt;</span></span>
<span><span class="co">#&gt; USER ALERT: Please manually inspect the short balancing formula below that includes time-varying confounders at t-1 only:</span></span>
<span><span class="co">#&gt; The short formula for ESETA1 - StrDif_Tot.58 at ESETA1 time point 58 is: </span></span>
<span><span class="co">#&gt; ESETA1.58 ~ BioDadInHH2 + caregiv_health + DrnkFreq + EARS_TJo.35 + </span></span>
<span><span class="co">#&gt;     ESETA1.35 + fscore.35 + gov_assist + HOMEETA1.35 + HomeOwnd + </span></span>
<span><span class="co">#&gt;     InRatioCor.35 + InRatioCor.6 + KFASTScr + LESMnNeg.35 + LESMnPos.35 + </span></span>
<span><span class="co">#&gt;     peri_health + PmAge2 + PmBlac2 + PmEd2 + PmMrSt2 + RHasSO.35 + </span></span>
<span><span class="co">#&gt;     RHealth + RMomAgeU + SmokTotl + state + StrDif_Tot.35 + SurpPreg + </span></span>
<span><span class="co">#&gt;     SWghtLB + TcBlac2 + WndNbrhood.35</span></span>
<span><span class="co">#&gt; &lt;environment: 0x5630949e29f0&gt;</span></span></code></pre></div>
<p><br></p>
<div class="section level3">
<h3 id="customize-updated-balancing-formulas-step-3">Customize Updated Balancing Formulas (Step 3)<a class="anchor" aria-label="anchor" href="#customize-updated-balancing-formulas-step-3"></a>
</h3>
<p>The default use of <code><a href="../reference/createFormulas.html">createFormulas()</a></code> with
<code>type = "update"</code> creates updated balancing formulas at each
exposure time point. Each formula contains all time invariant
confounders; time-varying confounders measured at the time point
directly prior (<em>t</em>-1 lag) to that exposure time point; as well
as any time-varying confounders at greater lags that were not
successfully balanced using the short balancing formulas.</p>
<p>When creating updated formulas, the user can specify the optional
<code>concur_conf</code>, <code>keep_conf</code>, and
<code>custom</code> arguments detailed above. Of note,
<code><a href="../reference/createFormulas.html">createFormulas()</a></code> does not check that formulas in the
<code>custom</code> field meet criteria for the updated formula or
identify any imbalanced confounders, and the user is responsible for
ensuring the validity of these formulas. <br></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Isabella Stallworthy, Noah Greifer, Meriah DeJoseph, Emily Padrutt, Daniel Berry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
